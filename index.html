<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Smart Offer Router</title>
</head>
<body>
<h3>Loading offer...</h3>

<script>
/* ========= CONFIG ========= */

const OFFERS = [
  "https://offerA.com",
  "https://offerB.com",
  "https://offerC.com"
];

const CLICK_CODE = "wen25tvh";

/* ========= HELPERS ========= */

const url = new URL(window.location.href);
let step = parseInt(url.searchParams.get("step") || "0", 10);
const domain = url.searchParams.get("domain");
const z = url.searchParams.get("z");

/* ========= VALIDATION ========= */

if (!domain || !z) {
  document.body.innerHTML = "Missing parameters";
  throw new Error("Invalid URL");
}

if (step >= OFFERS.length) {
  document.body.innerHTML = "<h2>No more offers</h2>";
  throw new Error("Done");
}

/* ========= BUILD OFFER URL ========= */

// example final url:
// https://offer.com/wen25tvh/12345
const offerUrl = `https://${domain}/${CLICK_CODE}/${z}`;

/* ========= NEXT STEP URL ========= */

url.searchParams.set("step", step + 1);

/* ========= REDIRECT ========= */

setTimeout(() => {
  // IMPORTANT: href, not replace
  window.location.href = offerUrl;
}, 300);
</script>

</body>
</html>
